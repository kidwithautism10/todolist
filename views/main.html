{{ define "main" }}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Main page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<style>
    body {
        background: #022027;
    }
    .inpt{
        background: #282828;
    }
    input[type="text"]::-webkit-input-placeholder {
        color: #FFF8DC;
    }
    input[type="text"]::-moz-placeholder {
        color: #FFF8DC;
    }
</style>
<script>
    function sendTaskJSON(){
        let xhr = new XMLHttpRequest();
        url = "http://" + location.host + "/todo/create";
        xhr.open("POST", url, true);

        var data = JSON.stringify({ "text":
            text.value});
        xhr.send(data);
        text.value = ""
        setTimeout(() => {  location.reload(); }, 100);
    }
    function sendCompleteJSON(id){
        let xhr = new XMLHttpRequest();
        url = "http://" + location.host + "/todo/update";
        xhr.open("POST", url, true);

        var data = JSON.stringify({ "id": id.toString()});
        xhr.send(data)
        setTimeout(() => {  location.reload(); }, 100);
        console.log(data);
    }
    function sendDeleteJSON(id){
        let xhr = new XMLHttpRequest();
        url = "http://" + location.host + "/todo/delete";
        xhr.open("DELETE", url, true);

        var data = JSON.stringify({ "id": id.toString()});
        xhr.send(data)
        setTimeout(() => {  location.reload(); }, 100);
        console.log(data);
    }
</script>
<body>
<div class="py-3">
    <div class="position-absolute start-50 translate-middle-x input-group w-50">
        <span class="input-group-text inpt" id="addon-wrapping">üíå</span>
        <input type="text" class="form-control inpt" placeholder="task..." id="text" aria-describedby="addon-wrapping">
        <button class="btn btn-outline-primary" type="button" onclick="sendTaskJSON()">add task</button>
    </div>
    <table class="table table-dark table-striped w-50 position-absolute start-50 translate-middle-x my-5">
        <thead>
        <tr>
            <th scope="col" class="w-auto">Done?</th>
            <th scope="col" class="w-100">Text</th>
            <th scope="col" class="w-auto">Date</th>
            <th scope="col" class="w-auto"></th>
        </tr>
        </thead>
        <tbody>
        {{range . }}
            {{ if eq .Text "–∑–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ :(" }}
                <tr valign="middle">
                    <th></th>
                    <td align="center">{{ .Text }}</td>
                    <td></td>
                    <td></td>
                </tr>
            {{ else }}
                <tr valign="middle">
                    <th scope="row"><input {{ if eq .Complete 1 }}checked{{ end }} class="form-check-input" type="checkbox" id="complete" onclick="sendCompleteJSON({{ .ID }})"></th>
                    <td>{{ .Text }}</td>
                    <td>{{ .Date }}</td>
                    <td><button class="btn btn-outline-danger" onclick="sendDeleteJSON({{.ID}})">-</button></td>
                </tr>
            {{ end }}
        {{ end }}

        </tbody>

    </table>
</div>
</body>
</html>
{{ end }}